<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bingo Casino Royale - Multiplayer</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="top-bar">
        <h2 style="font-size: 1.1rem;">üé∞ BINGO MULTIPLAYER</h2>
        <div class="balance-card">
            <span style="color:var(--text-dim); font-size: 0.7rem;">CREDITS</span>
            <span class="balance-amount" id="balance">1,000</span>
        </div>
    </div>

    <div class="container">
        <!-- Session Info -->
        <div class="session-info">
            <div>Session: <span id="sessionCount">1</span></div>
            <div class="session-timer">Status: <span id="sessionStatus">ACTIVE</span></div>
        </div>

        <!-- Number Selection -->
        <div class="section-title">
            <span>Choose Center Number</span>
            <span id="selected-label">Pick 1-200</span>
        </div>
        <div class="selector-box">
            <div class="numbers-scroll" id="numberGrid"></div>
            <div class="taken-info" id="takenInfo">Numbers in red are taken by other players</div>
        </div>

        <!-- Statistics Dashboard -->
        <div class="stats-dashboard">
            <div class="stat-box">
                <div class="stat-value" id="activePlayers">1</div>
                <div class="stat-label">Active Players</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="totalCards">1</div>
                <div class="stat-label">Cards Playing</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="winnersCount">0</div>
                <div class="stat-label">Session Wins</div>
            </div>
        </div>

        <!-- Hot Numbers Display -->
        <div class="hot-numbers-container">
            <div class="section-title">
                <span>üî• Hot Numbers (3h)</span>
                <span id="hotNumbersTime">Updated now</span>
            </div>
            <div class="hot-numbers" id="hotNumbers">
                <!-- Hot numbers will be populated by JavaScript -->
            </div>
        </div>

        <!-- Game Dashboard -->
        <div class="dashboard">
            <div id="status-text" style="font-size: 0.8rem; color: var(--text-dim);">
                GAME ACTIVE 
                <span id="gameStatusIndicator" class="game-status status-active">ACTIVE</span>
            </div>
            <div class="current-ball" id="ballDisplay">--</div>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar" style="width: 0%"></div>
            </div>
            <div style="font-size: 0.7rem; color: var(--primary);" id="progressText">Draw: <span id="drawCount">0</span> / 75</div>
            <div class="speed-indicator">Draw Speed: 1 number/second</div>
            <div class="next-draw">Next session in: <span id="nextSessionTimer">60</span>s</div>
            <div class="history-balls" id="historyBalls"></div>
        </div>

        <!-- Pattern Selection -->
        <div class="section-title">
            <span>Bingo Pattern</span>
            <span id="pattern-label">LINE</span>
        </div>
        <div class="pattern-selector" id="patternSelector"></div>

        <!-- Bingo Card -->
        <div class="bingo-card">
            <div class="bingo-header">
                <span>B</span><span>I</span><span>N</span><span>G</span><span>O</span>
            </div>
            <div class="bingo-grid" id="cardGrid"></div>
        </div>

        <!-- Game History Toggle -->
        <button class="history-toggle-btn" onclick="toggleGameHistory()">
            üìú Game History
            <span class="history-badge" id="historyBadge">0</span>
        </button>

        <!-- Controls -->
        <div class="controls">
            <button class="main-btn btn-secondary" onclick="toggleWagerModal()">üí∞ Bet: <span id="wagerBtnLabel">50</span></button>
            <button class="main-btn btn-secondary" onclick="resetPlayerGame()">üîÑ Leave Game</button>
            <button class="main-btn btn-play" id="startBtn" onclick="joinSession()">JOIN SESSION</button>
        </div>
    </div>

    <!-- Wager Modal -->
    <div class="modal" id="wagerModal">
        <div class="modal-content">
            <h3>Select Wager</h3>
            <div class="wager-ui">
                <button class="wager-btn" onclick="changeWager(-10)">-10</button>
                <button class="wager-btn" onclick="changeWager(-5)">-5</button>
                <div class="wager-display" id="modalWager">50</div>
                <button class="wager-btn" onclick="changeWager(5)">+5</button>
                <button class="wager-btn" onclick="changeWager(10)">+10</button>
            </div>
            <div style="font-size: 0.8rem; color: var(--text-dim); margin: 10px 0;">
                Min: 10 | Max: 500 | Balance: <span id="modalBalance">1000</span>
            </div>
            <button class="main-btn btn-play" onclick="toggleWagerModal()">CONFIRM</button>
        </div>
    </div>

    <!-- Win Modal -->
    <div class="modal" id="winModal">
        <div class="modal-content win">
            <h2 style="color: var(--secondary); margin-bottom: 15px;">üéâ BINGO! YOU WIN! üéâ</h2>
            <div style="font-size: 3rem; color: var(--accent); margin: 20px 0;" id="winAmount">+250</div>
            <div style="color: var(--text-dim); margin-bottom: 20px;">
                Pattern: <span id="winPattern">LINE</span><br>
                Draws: <span id="winDraws">25</span> / 75<br>
                Wager: <span id="winWager">50</span> credits
            </div>
            <button class="main-btn btn-play" onclick="closeWinModal()">JOIN NEXT SESSION</button>
        </div>
    </div>

    <!-- Lose Modal -->
    <div class="modal" id="loseModal">
        <div class="modal-content lose">
            <h2 style="color: var(--danger); margin-bottom: 15px;">üòî SESSION ENDED</h2>
            <div style="font-size: 2rem; color: var(--danger); margin: 20px 0;" id="loseAmount">-50</div>
            <div style="color: var(--text-dim); margin-bottom: 20px;">
                No bingo pattern completed<br>
                75 draws reached
            </div>
            <button class="main-btn btn-play" onclick="closeLoseModal()">JOIN NEXT SESSION</button>
        </div>
    </div>

    <!-- Waiting Modal -->
    <div class="modal" id="waitingModal">
        <div class="modal-content waiting">
            <h2 style="color: var(--accent); margin-bottom: 15px;">‚è≥ WAITING FOR NEXT SESSION</h2>
            <div style="font-size: 4rem; color: var(--accent); margin: 20px 0;" id="waitingTimer">60</div>
            <div style="color: var(--text-dim); margin-bottom: 20px;">
                Next session starts in <span id="waitingSeconds">60</span> seconds<br>
                Get ready to choose a new number!
            </div>
            <div style="font-size: 0.9rem; color: var(--text-dim);">
                Previous session winners: <span id="previousWinners">0</span>
            </div>
        </div>
    </div>

    <!-- Game History Modal -->
    <div class="modal" id="historyModal">
        <div class="modal-content history-modal">
            <h2 style="color: var(--primary); margin-bottom: 15px;">üìú GAME HISTORY</h2>
            <div class="history-tabs">
                <button class="history-tab active" onclick="switchHistoryTab('winners')">üèÜ Winners</button>
                <button class="history-tab" onclick="switchHistoryTab('numbers')">üî¢ Hot Numbers</button>
                <button class="history-tab" onclick="switchHistoryTab('stats')">üìä Statistics</button>
            </div>
            
            <div class="history-content" id="winnersTab">
                <div class="winners-list" id="winnersList">
                    <!-- Winners will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="history-content" id="numbersTab" style="display: none;">
                <div class="hot-numbers-analysis">
                    <h3>üéØ Most Likely Numbers (3h)</h3>
                    <div class="hot-numbers-grid" id="hotNumbersAnalysis">
                        <!-- Hot numbers analysis will be populated by JavaScript -->
                    </div>
                    <div class="probability-info">
                        <div class="prob-item">
                            <span class="prob-label">Next Number Probability:</span>
                            <span class="prob-value" id="nextNumberProb">15.2%</span>
                        </div>
                        <div class="prob-item">
                            <span class="prob-label">Average Draws to Win:</span>
                            <span class="prob-value" id="avgDrawsWin">32.5</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="history-content" id="statsTab" style="display: none;">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-card-value" id="totalGames">0</div>
                        <div class="stat-card-label">Total Games</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-value" id="totalWins">0</div>
                        <div class="stat-card-label">Total Wins</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-value" id="winRate">0%</div>
                        <div class="stat-card-label">Win Rate</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-value" id="totalWagered">0</div>
                        <div class="stat-card-label">Total Wagered</div>
                    </div>
                </div>
            </div>
            
            <button class="main-btn btn-secondary" onclick="closeHistoryModal()">CLOSE</button>
        </div>
    </div>

    <!-- Error Modal -->
    <div class="modal" id="errorModal">
        <div class="modal-content error-modal">
            <h2 style="color: var(--danger); margin-bottom: 15px;">‚ö†Ô∏è ERROR</h2>
            <div style="color: var(--text-main); margin-bottom: 20px;" id="errorMessage">
                An error has occurred. Please try again.
            </div>
            <button class="main-btn btn-play" onclick="closeErrorModal()">OK</button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="game.js"></script>
    <script src="patterns.js"></script>
    <script src="history.js"></script>
    <script src="stats.js"></script>
    <script src="multiplayer.js"></script>
    <script src="ui.js"></script>
    
    <!-- Initialize Game -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            try {
                GameState.initialize();
                UIManager.init();
                HistoryManager.init();
                StatsManager.init();
                MultiplayerManager.init();
                
                // Start the first game session
                GameSession.start();
                
                // Start hot numbers updates
                StatsManager.updateHotNumbers();
                
                // Load initial history
                HistoryManager.loadHistory();
                
                // Start simulation
                MultiplayerManager.startSimulation();
                
                console.log('Game initialized successfully');
            } catch (error) {
                ErrorHandler.showError(`Initialization failed: ${error.message}`);
                console.error('Initialization error:', error);
            }
        });
    </script>
</body>
</html>